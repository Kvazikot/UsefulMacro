
This project is licensed under the terms of the GNU General Public License v3.0

/*
+ - - - + - + - -
+ - + - + copyright by Vladimir Baranov (Kvazikot)  <br>
+ - + - + email: vsbaranov83@gmail.com  <br>
+ - + - + github: https://github.com/Kvazikot/UsefulMacro/UsefulClicker  <br>
```
                          )            (
                         /(   (\___/)  )\
                        ( #)  \ ('')| ( #
                         ||___c\  > '__||
                         ||**** ),_/ **'|
                   .__   |'* ___| |___*'|
                    \_\  |' (    ~   ,)'|
                     ((  |' /(.  '  .)\ |
                      \\_|_/ <_ _____> \______________
                       /   '-, \   / ,-'      ______  \
              b'ger   /      (//   \\)     __/     /   \
                                          './_____/
```
*/
## О программе Useful Clicker
Програма UC предназначена для программирования действий пользователя.
НАпример чтобы автоматически искать материалы в youtube и скачивать определенные ролики.
Программа имеет встроенный функционал компьютерного зрения, т.е. она может определить кнопки на экране путем анализа пикселов изображения.
В этом смысле она работает похоже на то как работает сетчатка глаза животного.
Кнопки подсвечиваются зеленым в стиле augmented reality.

![image](https://github.com/Kvazikot/UsefulMacro/blob/master/UsefulClicker/screenshots/buttons_detector_screenshot.png)

рис.1 Детектор кнопок

![image](https://github.com/Kvazikot/UsefulMacro/blob/master/UsefulClicker/screenshots/delay_widget.png)

рис.2 Виджет установки задержек

![image](https://github.com/Kvazikot/UsefulMacro/blob/master/UsefulClicker/screenshots/xml_editor_screenshot.png)

рис.3 Редактор программы кликера в виде xml дерева.

![image](https://github.com/Kvazikot/UsefulMacro/blob/master/UsefulClicker/screenshots/xml_editor_screenshot2.png)

рис.4 Редактор программы кликера в виде xml дерева с картинками справа. 

![image](https://github.com/Kvazikot/UsefulMacro/blob/master/UsefulClicker/screenshots/Cool_tests_form.png)

рис.5 Крутая тестовая программа 


## Новая концепция для Useful Clicker (3/28/2022)
Программа должна распознавать контекст. Т.е. какое окно сейчас на экране, какие кнопки на экране.
Все кнопки она обводит зеленым цветом, а кнопку которую нужно кликнуть в красное.
Еще он подписывает порядковый номер действия рядом с кнопкой.
Все это можно устроить в полноэкранном полупрозрачном виджете.
Кнопки "Следующий фрейм" и "Предыдущий фрейм" на верху экрана.
Т..е кликер работает и в режиме программирования кликера. Чтобы вернуть предыдущее окно например.


## Недостатки Auto Mouse Clicker by MurGee

Что хотелось бы улучшить в клоне программы с рабочим названием UsefulClicker?

0. Не бесплатная
1. работает только под Windows (платформозависимое ограничение свободной воли )
2. Отстствие полноценного экспорта в формате csv.
В особенности пугает невозможность сохранить комбинации Hot Key.
2. Нельзя запустить несколько скриптов в рамках одного процесса.
Например просмотр почты, потом произвольное переключение циклического поиска в ютьюбе и т.д.
2.1 В программе нет понятия процедуры или функции. 
В табличке действий я не могу свернуть действия в замыкание и назвать его как-то.
А потом сделать место для главного цикла внизу таблицы действий

3. Нет экспорта скрипта на какой-то из известных языков программирования, в частности 
visual basic.
4. Слишком большое выпадающее меню действий. Я бы ограничился следующими (см. [LA1]).
5. Нельзя перемещать несколько действий в списке. 
6. Нельзя копировать вставлять строки таблицы \ скрипта
7. Действия попадают в конец списка, а не в выделение.
8. НЕ оптимизирована под GPU
9. Нет поиска изображения на разных масштабах. 
10. Нельзя менять комменты прямо в таблице.
11. НЕту встроенных комбобоксов в таблице, например чтобы поменять Scroll up на Scroll Down 
12. Нет условных переходов 
13. Нет переменных 
14. Не понимает переменные среды, например %TMP%
15. Нет оператора goto
16. Нет арифметических функций
17.
12 - 17 недостатки касаются инструкций кликера.
(может быть более это намеренно сделано более предсказуемые скрипты)
все перечисленные ниже вещи можно делать во внешнем скрипте


[LA1] List of actions
--------------------------------
* Hot key
* Press Key
* Left click
* Right click
* Scroll down
* Scroll up
* Launch program
* Image search
* Type Comment

# Проблемы
1. Существующие скрипты, которые я написал в рамках НИОКР невозможно перевести в открытую форму без действующей лицензии.
НАдо потратить время для их переписывания в UsefulClicker.
Либо сделать обратную совместимость с AMC, все зависит появится ли связь с отделом индиской поддержк. 
Я думаю что ему эта идея на вряд ли понравится.

# Возможные фичи 
1. Автоматический Поиск кнопок без необходимости обводить их в пямоугольную область пикселей
2. Автоматическое распознавание разметки веб страницы или областей формы типа виджетов.
3. РАспознавание областей текста и областей где есть картинки как OCR системах
Метод поиска текста по гистограмме. Текст делится на прямоугольные области, потом они отбрасываются при поиске целевой картинки.
В последствии если очень захотеть можно добавить cnn для распознавания текста.
Но для начала система должна подсвечивать кнопки и давать им порядковый номер. 
После чего юзер выбирает мышкой уже подсвеченные области, а не выделяет области прямоугольником как у индуса.
5. Встроенный интерпретатор, луа, пайтон, vbs. Вставка пайтоновского кода в ячейки таблицы. 
6. Эксель тоже моджно рассмотреть особенно если двигаться в сторону data science.
7. Интересна идея самообучение кликера по действиям оператора (типа режим ребенка, режим бабушки). В AMC это называется MacroRecorder. Но важно чтобы он както сегментировал дествия в отдельные записи. 
8. Ну тут же сразу приходит на ум распознавание собственно пользователя по скорости печати, характерным движениям мыши etc. Но это уже задача третьему рейху, а не ко мне. Я марать руки в говне не собираюсь.
 
10. Нужно сделать плагиноподобную среду внутри UsefulClicker
11. Надо сделать какуюто защиту от рейха :) Я уже сделал - все коды открытые, кроме Windows и пайтона. А так все открытые.
12. Функция RegEx как в AMC, но с опреатором goto. 
13. Встроить mingw компилятор в систему для написания кода на си++ в виде подключаемых длл плагин модулей. Это даст бустинг в скорости, если это требуется разработчику.
14. Скрипты для кликера будут сохраняться в DomModel. XML схема
15. XML схемы можно включать друг в друга.
16. В XML схему можно включить код скриптов на пайтоне и бейсике
17. Для редактирования скрипта на языке пайтон или бейсик на первых парах будет использоваться Notepad++
18. То есть интерпетраттор пайтона я все таки встрою в табличку. То етсь там будет типа вычислимых или интерпретируемых ячеек.
19. В программе будет три вида экспорта. XML схема. Набор скриптов. И экспорт в один пайтоновский скрипт еоторый работает независимо от кликера.
20. Тег скрипта <script> </script> нужно перепарсить так чтобы видно было строчки без запарок с табами в случае патона.
21. Сделать обфускацию строк если это требуется разоработчику
22. Сделать бинарный экспорт 
23. При импорте из xml схемы все теги <script> сохраняются в отдельные .py файлы в каталог scripts
24. OCR всех областей найлденных ButtonDetector например с помощью трансофрмера https://huggingface.co/docs/transformers/model_doc/trocr  

  
# Запись макроса с кодогенерацией оптимального xml кода, 
  входные данные: для которого траекторию мыши и события клавиатуры.   
  выход: минимальный xml код, желательно с понятным человеку содержанием    
  ```
  <window template="notepad_template.png"/>
  <menuclick> File -> Open </menuclick>
  <inputline> readme.txt </inputline>
  ````
 
# Список виджетов UsefulClicker
* [TimerWidget](https://github.com/Kvazikot/UsefulMacro/blob/master/UsefulClicker/widgets/README.MD#timerwidget)
* AreaButton
* Comboedit
* CrossButton
* KeyboardButton
* MouseButton
* 


## Comboedit
Этот виджет встраивается в ячейку таблицы
Представляется как обычная ячейка но справа от нее панель кнопок.
Мышь олицетворяет собой события от манипулятора мышь, включаая левый клик, правый клик и скролл.
Состояние каждой кнопки запоминается и восстанавливается при редактировании другой ячейки таблицы.
Состояние ячеек отличных от текущей отображается одним значком (например только mouse или только keyboard)




## CrossButton
Виджет представлен красным кремтом, который удаляет текст в текущей ячейке. 
Может быть текущий ряд.

## TimerWidget
Таймерный виджет.

Описание: Дизайн этого виджета представляет собой часы с тремя цциферблатами и одной квадратной форточки. 
Позволяет установить 3 параметра.

1. delay_before
2. random_delay_delta
3. repeats

### TimerWidget. Реализация и используемые API:
1. Первый варинат может быть реализован с помощью унаследованного лейбла с custom paint event
2. Варнант на основе SvgWidget с анимацией
3. OpenGL рендеринг с возможностью сферических часов в вакууме, которые можно крутить по всем осям.

### TimerWidget. Два режима отображения виджета.
1. В отдельном окне
2. Внутри ячейки таблицы как кнопка, но с состоянием 3 циферблатов для визуальной оценки интервалов

### TimerWidget. Максимум и минимум интервалов.
В уменьшенной версии можно задавать по умолчанию в секундах с плавающей точкой
max_interval = 12.2 sec
В полноэкранной версии виджета можно рисовать бекгроунд и заадавать пределы циферблатов.

### TimerWidget. Анимация 
* Циферблаты мигают. 
* Градиентная заливка
* Блюр можно не делать






